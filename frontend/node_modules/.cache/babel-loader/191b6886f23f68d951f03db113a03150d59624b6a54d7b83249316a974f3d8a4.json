{"ast":null,"code":"import _objectSpread from\"/Users/payalkawar/Downloads/drug/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useReducer,useEffect}from\"react\";import toast from\"react-hot-toast\";import dataService from\"../services/dataService\";// Initial state\nimport{jsx as _jsx}from\"react/jsx-runtime\";const initialState={user:null,loading:true,error:null};// Action types\nconst AUTH_ACTIONS={LOGIN_START:\"LOGIN_START\",LOGIN_SUCCESS:\"LOGIN_SUCCESS\",LOGIN_FAILURE:\"LOGIN_FAILURE\",LOGOUT:\"LOGOUT\",REGISTER_START:\"REGISTER_START\",REGISTER_SUCCESS:\"REGISTER_SUCCESS\",REGISTER_FAILURE:\"REGISTER_FAILURE\",UPDATE_PROFILE:\"UPDATE_PROFILE\",SET_LOADING:\"SET_LOADING\",CLEAR_ERROR:\"CLEAR_ERROR\"};// Reducer\nconst authReducer=(state,action)=>{switch(action.type){case AUTH_ACTIONS.LOGIN_START:case AUTH_ACTIONS.REGISTER_START:return _objectSpread(_objectSpread({},state),{},{loading:true,error:null});case AUTH_ACTIONS.LOGIN_SUCCESS:case AUTH_ACTIONS.REGISTER_SUCCESS:return _objectSpread(_objectSpread({},state),{},{user:action.payload.user,loading:false,error:null});case AUTH_ACTIONS.LOGIN_FAILURE:case AUTH_ACTIONS.REGISTER_FAILURE:return _objectSpread(_objectSpread({},state),{},{user:null,loading:false,error:action.payload});case AUTH_ACTIONS.LOGOUT:return _objectSpread(_objectSpread({},state),{},{user:null,loading:false,error:null});case AUTH_ACTIONS.UPDATE_PROFILE:return _objectSpread(_objectSpread({},state),{},{user:_objectSpread(_objectSpread({},state.user),action.payload)});case AUTH_ACTIONS.SET_LOADING:return _objectSpread(_objectSpread({},state),{},{loading:action.payload});case AUTH_ACTIONS.CLEAR_ERROR:return _objectSpread(_objectSpread({},state),{},{error:null});default:return state;}};// Create context\nconst AuthContext=/*#__PURE__*/createContext();// Auth provider component\nexport const AuthProvider=_ref=>{let{children}=_ref;const[state,dispatch]=useReducer(authReducer,initialState);// No axios interceptors needed for localStorage\n// Check for existing authentication on mount\nuseEffect(()=>{const checkAuth=()=>{const user=dataService.getCurrentUser();const token=localStorage.getItem(\"accessToken\");if(!token||!user){dispatch({type:AUTH_ACTIONS.SET_LOADING,payload:false});return;}dispatch({type:AUTH_ACTIONS.LOGIN_SUCCESS,payload:{user}});};checkAuth();},[]);// Login function\nconst login=async credentials=>{dispatch({type:AUTH_ACTIONS.LOGIN_START});try{const result=await dataService.login(credentials.username,credentials.password);if(result.success){dispatch({type:AUTH_ACTIONS.LOGIN_SUCCESS,payload:{user:result.user}});toast.success(\"Login successful!\");return{success:true,user:result.user};}else{dispatch({type:AUTH_ACTIONS.LOGIN_FAILURE,payload:result.message});toast.error(result.message);return{success:false,error:result.message};}}catch(error){const errorMessage=\"Login failed\";dispatch({type:AUTH_ACTIONS.LOGIN_FAILURE,payload:errorMessage});toast.error(errorMessage);return{success:false,error:errorMessage};}};// Register function\nconst register=async userData=>{dispatch({type:AUTH_ACTIONS.REGISTER_START});try{const result=await dataService.register(userData);if(result.success){dispatch({type:AUTH_ACTIONS.REGISTER_SUCCESS,payload:{user:result.user}});toast.success(\"Registration successful!\");return{success:true,user:result.user};}else{dispatch({type:AUTH_ACTIONS.REGISTER_FAILURE,payload:result.message});toast.error(result.message);return{success:false,error:result.message};}}catch(error){const errorMessage=\"Registration failed\";dispatch({type:AUTH_ACTIONS.REGISTER_FAILURE,payload:errorMessage});toast.error(errorMessage);return{success:false,error:errorMessage};}};// Logout function\nconst logout=async()=>{try{dataService.logout();dispatch({type:AUTH_ACTIONS.LOGOUT});toast.success(\"Logged out successfully\");}catch(error){console.error(\"Logout failed:\",error);}};// Update profile function\nconst updateProfile=async profileData=>{try{// For localStorage version, just update current user\nconst currentUser=dataService.getCurrentUser();const updatedUser=_objectSpread(_objectSpread({},currentUser),profileData);localStorage.setItem(\"currentUser\",JSON.stringify(updatedUser));dispatch({type:AUTH_ACTIONS.UPDATE_PROFILE,payload:updatedUser});toast.success(\"Profile updated successfully!\");return{success:true,user:updatedUser};}catch(error){const errorMessage=\"Profile update failed\";toast.error(errorMessage);return{success:false,error:errorMessage};}};// Change password function\nconst changePassword=async passwordData=>{try{// For localStorage version, this is a placeholder\ntoast.success(\"Password changed successfully!\");return{success:true};}catch(error){const errorMessage=\"Password change failed\";toast.error(errorMessage);return{success:false,error:errorMessage};}};// Clear error function\nconst clearError=()=>{dispatch({type:AUTH_ACTIONS.CLEAR_ERROR});};// Check if user has specific role\nconst hasRole=role=>{var _state$user;return((_state$user=state.user)===null||_state$user===void 0?void 0:_state$user.role)===role;};// Check if user has any of the specified roles\nconst hasAnyRole=roles=>{var _state$user2;return roles.includes((_state$user2=state.user)===null||_state$user2===void 0?void 0:_state$user2.role);};// Check if user is authenticated\nconst isAuthenticated=()=>{return!!state.user&&!!localStorage.getItem(\"accessToken\");};const value={// State\nuser:state.user,loading:state.loading,error:state.error,// Actions\nlogin,register,logout,updateProfile,changePassword,clearError,// Utility functions\nhasRole,hasAnyRole,isAuthenticated};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:value,children:children});};// Custom hook to use auth context\nexport const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error(\"useAuth must be used within an AuthProvider\");}return context;};export default AuthContext;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}