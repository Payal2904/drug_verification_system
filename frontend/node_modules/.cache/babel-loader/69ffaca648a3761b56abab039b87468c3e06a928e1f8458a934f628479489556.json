{"ast":null,"code":"import React,{useState,useCallback}from'react';import{Camera,Upload,FileImage,CheckCircle,AlertTriangle,Shield,Scan}from'lucide-react';import{motion,AnimatePresence}from'framer-motion';import toast from'react-hot-toast';import CameraScanner from'../components/scanning/CameraScanner';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const ScanPage=()=>{const[scanMode,setScanMode]=useState('camera');// 'camera', 'upload'\nconst[scanType,setScanType]=useState('all');// 'qr', 'barcode', 'all'\nconst[isScanning,setIsScanning]=useState(false);const[scanResult,setScanResult]=useState(null);const[verificationResult,setVerificationResult]=useState(null);const[isVerifying,setIsVerifying]=useState(false);const[uploadedImage,setUploadedImage]=useState(null);// Mock verification data\nconst mockVerificationData={'QR001PARA500BATCH001':{isAuthentic:true,drug:{name:'Paracetamol',strength:'500mg',manufacturer:'PharmaCorp Ltd',batchNumber:'BATCH001',expiryDate:'2025-12-31',manufacturingDate:'2023-01-15'},supplyChain:[{stage:'Manufacturing',location:'Mumbai, India',date:'2023-01-15',verified:true},{stage:'Distribution',location:'Delhi, India',date:'2023-01-20',verified:true},{stage:'Retail',location:'Local Pharmacy',date:'2023-01-25',verified:true}]},'QR002AMOX250BATCH002':{isAuthentic:true,drug:{name:'Amoxicillin',strength:'250mg',manufacturer:'MediCore Industries',batchNumber:'BATCH002',expiryDate:'2025-06-30',manufacturingDate:'2023-02-10'},supplyChain:[{stage:'Manufacturing',location:'Chennai, India',date:'2023-02-10',verified:true},{stage:'Distribution',location:'Bangalore, India',date:'2023-02-15',verified:true},{stage:'Retail',location:'Local Pharmacy',date:'2023-02-20',verified:true}]},'123456789012':{isAuthentic:true,drug:{name:'Ibuprofen',strength:'400mg',manufacturer:'HealthFirst Pharma',batchNumber:'BATCH003',expiryDate:'2025-08-15',manufacturingDate:'2023-03-05'},supplyChain:[{stage:'Manufacturing',location:'Pune, India',date:'2023-03-05',verified:true},{stage:'Distribution',location:'Mumbai, India',date:'2023-03-10',verified:true},{stage:'Retail',location:'Local Pharmacy',date:'2023-03-15',verified:true}]},'987654321098':{isAuthentic:true,drug:{name:'Aspirin',strength:'75mg',manufacturer:'CardioCare Ltd',batchNumber:'BATCH004',expiryDate:'2025-11-20',manufacturingDate:'2023-04-01'},supplyChain:[{stage:'Manufacturing',location:'Hyderabad, India',date:'2023-04-01',verified:true},{stage:'Distribution',location:'Kolkata, India',date:'2023-04-06',verified:true},{stage:'Retail',location:'Local Pharmacy',date:'2023-04-11',verified:true}]}};// Handle successful scan\nconst handleScanSuccess=useCallback(async result=>{setScanResult(result);setIsVerifying(true);try{// Simulate API call\nawait new Promise(resolve=>setTimeout(resolve,1500));const verification=mockVerificationData[result.data]||{isAuthentic:false,drug:{name:'Unknown Drug',manufacturer:'Unknown',batchNumber:'Unknown'},error:'Drug not found in database or potentially counterfeit'};setVerificationResult(verification);if(verification.isAuthentic){toast.success('Drug verified successfully!');}else{toast.error('Warning: Potentially counterfeit drug detected!');}}catch(error){console.error('Verification error:',error);toast.error('Verification failed. Please try again.');}finally{setIsVerifying(false);}},[]);// Handle scan error\nconst handleScanError=useCallback(error=>{console.error('Scan error:',error);toast.error('Scanning failed. Please check camera permissions.');},[]);// Handle file upload\nconst handleFileUpload=useCallback(event=>{const file=event.target.files[0];if(file){if(file.type.startsWith('image/')){const reader=new FileReader();reader.onload=e=>{setUploadedImage(e.target.result);// Simulate scanning from uploaded image\nsetTimeout(()=>{// Mock QR detection from image\nconst mockResult={type:'qr',data:'QR001PARA500BATCH001'};handleScanSuccess(mockResult);},1000);};reader.readAsDataURL(file);}else{toast.error('Please select a valid image file.');}}},[handleScanSuccess]);// Reset scan\nconst resetScan=useCallback(()=>{setScanResult(null);setVerificationResult(null);setUploadedImage(null);},[]);return/*#__PURE__*/_jsxs(\"div\",{className:\"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"container mx-auto px-4 py-6\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-4xl mx-auto\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"text-center mb-6\",children:[/*#__PURE__*/_jsx(motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:\"inline-flex items-center justify-center w-16 h-16 bg-blue-100 rounded-full mb-4\",children:/*#__PURE__*/_jsx(Scan,{className:\"h-8 w-8 text-blue-600\"})}),/*#__PURE__*/_jsx(\"h1\",{className:\"text-2xl md:text-3xl font-bold text-gray-900 mb-2\",children:\"Drug Scanner\"}),/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-600 max-w-2xl mx-auto\",children:\"Scan QR codes or barcodes to instantly verify drug authenticity and view complete supply chain information.\"})]}),!scanResult&&/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:\"bg-white rounded-xl shadow-soft p-6 mb-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex flex-col sm:flex-row gap-4 mb-6\",children:[/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setScanMode('camera'),className:\"flex-1 p-4 rounded-lg border-2 transition-all \".concat(scanMode==='camera'?'border-blue-500 bg-blue-50 text-blue-700':'border-gray-200 hover:border-gray-300'),children:[/*#__PURE__*/_jsx(Camera,{className:\"h-6 w-6 mx-auto mb-2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium\",children:\"Camera Scan\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:\"Use device camera\"})]}),/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setScanMode('upload'),className:\"flex-1 p-4 rounded-lg border-2 transition-all \".concat(scanMode==='upload'?'border-blue-500 bg-blue-50 text-blue-700':'border-gray-200 hover:border-gray-300'),children:[/*#__PURE__*/_jsx(Upload,{className:\"h-6 w-6 mx-auto mb-2\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-sm font-medium\",children:\"Upload Image\"}),/*#__PURE__*/_jsx(\"div\",{className:\"text-xs text-gray-500\",children:\"Select from gallery\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-6\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium text-gray-700 mb-2\",children:\"What would you like to scan?\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-3 gap-2\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setScanType('all'),className:\"p-3 rounded-lg text-xs font-medium transition-all \".concat(scanType==='all'?'bg-blue-500 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:\"Any Code\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setScanType('qr'),className:\"p-3 rounded-lg text-xs font-medium transition-all \".concat(scanType==='qr'?'bg-blue-500 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:\"QR Code Only\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setScanType('barcode'),className:\"p-3 rounded-lg text-xs font-medium transition-all \".concat(scanType==='barcode'?'bg-blue-500 text-white':'bg-gray-100 text-gray-700 hover:bg-gray-200'),children:\"Barcode Only\"})]})]}),scanMode==='camera'?/*#__PURE__*/_jsxs(\"button\",{onClick:()=>setIsScanning(true),className:\"w-full btn btn-primary btn-lg\",children:[/*#__PURE__*/_jsx(Camera,{className:\"h-5 w-5 mr-2\"}),\"Start Camera Scan\"]}):/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",accept:\"image/*\",onChange:handleFileUpload,className:\"hidden\",id:\"image-upload\"}),/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"image-upload\",className:\"w-full btn btn-primary btn-lg cursor-pointer inline-flex items-center justify-center\",children:[/*#__PURE__*/_jsx(FileImage,{className:\"h-5 w-5 mr-2\"}),\"Select Image\"]})]})]}),uploadedImage&&!verificationResult&&/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,scale:0.9},animate:{opacity:1,scale:1},className:\"bg-white rounded-xl shadow-soft p-6 mb-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold mb-4\",children:\"Uploaded Image\"}),/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center mb-4\",children:/*#__PURE__*/_jsx(\"img\",{src:uploadedImage,alt:\"Uploaded scan\",className:\"max-w-full max-h-64 rounded-lg\"})}),isVerifying&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"inline-flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"animate-spin w-5 h-5 border-2 border-blue-600 border-t-transparent rounded-full mr-2\"}),/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Analyzing image...\"})]})})]}),/*#__PURE__*/_jsx(AnimatePresence,{children:verificationResult&&/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:\"bg-white rounded-xl shadow-soft overflow-hidden\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"p-6 \".concat(verificationResult.isAuthentic?'bg-gradient-to-r from-green-500 to-green-600':'bg-gradient-to-r from-red-500 to-red-600',\" text-white\"),children:/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[verificationResult.isAuthentic?/*#__PURE__*/_jsx(CheckCircle,{className:\"h-8 w-8 mr-3\"}):/*#__PURE__*/_jsx(AlertTriangle,{className:\"h-8 w-8 mr-3\"}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-bold\",children:verificationResult.isAuthentic?'Authentic Drug':'Warning: Suspicious Drug'}),/*#__PURE__*/_jsx(\"p\",{className:\"text-sm opacity-90\",children:verificationResult.isAuthentic?'This drug has been verified as authentic':'This drug could not be verified or may be counterfeit'})]})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"p-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-6\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4\",children:\"Drug Information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-3\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Name:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:verificationResult.drug.name})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Strength:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:verificationResult.drug.strength||'N/A'})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Manufacturer:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:verificationResult.drug.manufacturer})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Batch Number:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:verificationResult.drug.batchNumber})]}),verificationResult.drug.expiryDate&&/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"text-gray-600\",children:\"Expiry Date:\"}),/*#__PURE__*/_jsx(\"span\",{className:\"font-medium\",children:verificationResult.drug.expiryDate})]})]})]}),verificationResult.supplyChain&&/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-900 mb-4 flex items-center\",children:[/*#__PURE__*/_jsx(Shield,{className:\"h-5 w-5 mr-2 text-blue-600\"}),\"Supply Chain\"]}),/*#__PURE__*/_jsx(\"div\",{className:\"space-y-3\",children:verificationResult.supplyChain.map((stage,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"w-3 h-3 rounded-full mr-3 \".concat(stage.verified?'bg-green-500':'bg-gray-400')}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"font-medium text-sm\",children:stage.stage}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-xs text-gray-500\",children:[stage.location,\" - \",stage.date]})]})]},index))})]})]}),verificationResult.error&&/*#__PURE__*/_jsx(\"div\",{className:\"mt-6 p-4 bg-red-50 border border-red-200 rounded-lg\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-red-700 text-sm\",children:verificationResult.error})}),/*#__PURE__*/_jsxs(\"div\",{className:\"mt-6 flex flex-col sm:flex-row gap-4\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:resetScan,className:\"btn btn-outline flex-1\",children:\"Scan Another Drug\"}),!verificationResult.isAuthentic&&/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-error flex-1\",children:\"Report Counterfeit\"})]})]})]})}),!scanResult&&/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:0.3},className:\"mt-8 bg-blue-50 rounded-xl p-6\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-blue-900 mb-4\",children:\"Scanning Tips\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid md:grid-cols-2 gap-4 text-sm\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-blue-800 mb-2\",children:\"For best results:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-blue-700 space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Ensure good lighting\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Hold device steady\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Keep code within the frame\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Clean the camera lens\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h4\",{className:\"font-medium text-blue-800 mb-2\",children:\"Supported formats:\"}),/*#__PURE__*/_jsxs(\"ul\",{className:\"text-blue-700 space-y-1\",children:[/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 QR Codes\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 EAN-13 Barcodes\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Code 128 Barcodes\"}),/*#__PURE__*/_jsx(\"li\",{children:\"\\u2022 Data Matrix Codes\"})]})]})]})]})]})}),/*#__PURE__*/_jsx(CameraScanner,{isOpen:isScanning,onClose:()=>setIsScanning(false),onScanSuccess:handleScanSuccess,onError:handleScanError,scanType:scanType})]});};export default ScanPage;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}